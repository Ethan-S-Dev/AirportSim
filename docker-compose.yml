version: '3.5'

services:
  airport-sim-control-tower:
    build:
      context: ./AirportSim
      dockerfile: ./Dockerfile
    container_name: airport-sim-control-tower
    restart: always
    environment:
      ASPNETCORE_ENVIRONMENT: Docker
      SQL_SERVER: Server=airportsim-mssql;Database=AirportSim.db;User=sa;Password=Pa55!W0rd
      SIGNALR_CLIENT: http://localhost:4200
      SIMULATOR_CLIENT: non
    ports:
      - "5050:80"
    depends_on: 
      - airportsim-mssql
    networks:
      - airportsim_network

  airportsim-mssql:
    image: mcr.microsoft.com/mssql/server
    container_name: airportsim-mssql
    volumes: 
      - airportsim_mssql_volume:/var/opt/mssql
    restart: always
    environment:
      SA_PASSWORD: Pa55!W0rd
      ACCEPT_EULA: Y
    networks:
      - airportsim_network

networks: 
  airportsim_network:
    driver: bridge

volumes: 
  airportsim_mssql_volume: {}
